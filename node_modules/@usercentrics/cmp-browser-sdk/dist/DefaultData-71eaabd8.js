import{d as e,g as n,s,v as t,h as r,i,E as a,A as u,m as c,j as o,_ as l,a as d,k as v,l as f,n as g}from"./index-bf2a0917.js";var h=function(o){function g(e,h,S){var b=o.call(this,S)||this;return b.categorySlug=e.categorySlug,b.consent=n(e,h),b.id=e.templateId,b.isEssential=h.isEssential,b.isHidden=!!h.isHidden||e.isHidden,b.processorId="".concat(s(t())),b.subServices=[],b.subServicesLength=e.subConsents?e.subConsents.length:0,b.version=e.version,b.fetchSubServices=function(){return r(b,void 0,void 0,(function(){var n,s,t,r,o;return i(this,(function(i){switch(i.label){case 0:if(n=u.getInstance(),s=e.subConsents,!(t=c(s)).length)return[2,[]];o=null,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,n.fetchAggregatedServices(t,!1)];case 2:return r=i.sent(),[4,n.fetchTranslations()];case 3:return o=i.sent(),[3,5];case 4:throw i.sent(),new Error(a.FETCH_DATA_PROCESSING_SERVICES);case 5:return r&&s?(this.subServices=s.reduce((function(e,n){var s=null==r?void 0:r.find((function(e){return n.templateId===e.templateId&&n.version===e.version}));if(!s)return l([],d(e),!1);var t=new g(n,h,s);return l(l([],d(e),!1),[t],!1)}),[]),[2,this.subServices.reduce((function(e,n){var t=s.find((function(e){return n.id===e.templateId&&n.version===e.version}));if(!t)return l([],d(e),!1);var i=new v(t,o,r),a=f(f(f({},i),n),{subServices:[]});return l(l([],d(e),!1),[a],!1)}),[])]):[2,[]]}}))}))},b}return e(g,o),g}(o),S=function(e,n,s){this.isEssential=e.isEssential,this.isHidden=e.isHidden,this.services=b(e,n,s),this.slug=e.categorySlug},b=function(e,n,s){return n.reduce((function(n,t){if(t.categorySlug===e.categorySlug){var r=null==s?void 0:s.find((function(e){return t.templateId===e.templateId&&t.version===e.version})),i=new h(t,e,r);return l(l([],d(n),!1),[i],!1)}return l([],d(n),!1)}),[])},p=function(e,n,s){this.categories=e.categories.reduce((function(n,t){var r=new S(t,e.consentTemplates,s);return g(r.services)?l(l([],d(n),!1),[r],!1):l([],d(n),!1)}),[]),this.controllerId=n};export{p as default};
